<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  metal:use-macro="context/@@groupserver_layout/page">
  <head>
    <title metal:fill-slot="title">
      <span tal:replace="string:${view/label}: ${view/groupInfo/name}: ${view/siteInfo/get_name}">
        Edit Image
      </span>
    </title>
  </head>
  <body>
    <div metal:fill-slot="messages" tal:condition="view/status" 
      class="message-error"
      tal:define="e view/errors"
      tal:attributes="class python:e and 'message-error' or 'message-result'">
      <p class="form-status" tal:content="structure view/status"/>
      <dl tal:condition="view/errors">
        <tal:block repeat="widget view/widgets">
          <tal:block tal:condition="widget/error">
            <dt tal:content="widget/label">Widget Name</dt>
            <dd class="error" 
              tal:content="structure widget/error">Error message</dd>
          </tal:block>
        </tal:block>
      </dl>
    </div>
    <tal:block metal:fill-slot="body">
      <!--=mpj17= Check GS join permission -->
      <h1>
        <span tal:content="view/label"/> 
        <span class="group" tal:content="view/groupInfo/name"/>        
      </h1>
      <p tal:condition="view/userInfo/anonymous">
        Log in to join.
      </p>
      <form tal:condition="view/canJoin"
        enctype="multipart/form-data"  method="post" action="."
        tal:attributes="action request/URL" id="join">
        <p id="introduction">
          Joining 
          <span class="group" tal:content="view/groupInfo/name"/>
          will allow you to <strong>receive email</strong> 
          from the group<tal:block condition="view/willPost">, and
          <strong>post</strong> to the group</tal:block>.
          To join 
          <span class="group" tal:content="view/groupInfo/name"/>,
          set how frequently you want to receive messages below, and
          click <samp class="button">Join</samp>.
        </p>
        <tal:block define="widgets view/widgets">
          <tal:block replace="structure provider:groupserver.FormWidgets"/>
        </tal:block>
        <div class="buttons" tal:condition="view/availableActions">
          <tal:block repeat="action view/actions">
            <div class="formelementbutton">
              <span tal:replace="structure action/render">Button</span>
            </div>
          </tal:block>
        </div><!--buttons-->
      </form>
      <div id="is-member" tal:condition="view/isMember">
        <p>
          You are a member of
          <span class="group" tal:content="view/groupInfo/name"/>
          and can participate by going to
          <a href="#" tal:attributes="href view/groupInfo/url">the
            group homepage.</a>
        </p>
      </div><!--is-member-->
      <div id="cannot-join" 
        tal:condition="python:not(view.canJoin) and not(view.isMember) and not(view.userInfo.anonymous)">
        <p>
          You cannot join 
          <span class="group" tal:content="view/groupInfo/name"/>.
        </p>
      </div><!--cannot-join-->
    </tal:block>
    <!--=mpj17= I do not handle the corner-case where a person
      - has been invited to join a group, but goes to the join page.
      - The best solution will be to present the join page, and 
      - then process the data as if it had been a response to an
      - invitation.
      -->
    <tal:block metal:fill-slot="javascript">
      <script type="text/javascript"
        src="/++resource++popup_help-20071218.js">&#160;</script>
      <script type="text/javascript">
        jQuery.noConflict()
        jQuery(document).ready( function () {
            GSPopupFormHelp.init('#join');
        });
      </script>
    </tal:block>
  </body>
</html>

